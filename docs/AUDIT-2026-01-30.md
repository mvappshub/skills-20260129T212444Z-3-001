# SilvaPlan - Audit Report & Action Plan

**Datum:** 30. ledna 2026 (aktualizovÃ¡no 31. ledna 2026)
**Autor:** Claude (Superpowers)
**Verze:** 0.2.0

---

## ğŸ“Š Executive Summary

**AktuÃ¡lnÃ­ stav:** SilvaPlan je funkÄnÃ­ MVP s modernÃ­ MapLibre GL mapou a Supabase backendem. Aplikace umoÅ¾Åˆuje evidenci a plÃ¡novÃ¡nÃ­ vÃ½sadby stromÅ¯ po ÄŒR.

| Metrika | Hodnota |
|---------|---------|
| Health Score | **85/100** |
| Komponenty | 12 âœ… |
| Services | 8 âœ… |
| TypeScript | âœ… OK |
| Test coverage | 0% âš ï¸ |

---

## âœ… HOTOVÃ‰ (Production-Ready)

| Komponenta | Stav | PoznÃ¡mka |
|------------|------|----------|
| **Mapa (MapLibre GL)** | âœ… | WebGL, CartoDB Positron |
| **Supabase Client** | âœ… | `lib/supabase.ts` |
| **Event Service** | âœ… | CRUD pro events + event_items |
| **Tree Service** | âœ… | CRUD pro trees + tree_photos |
| **Alert Service** | âœ… | MeteoAlarm + drought detection |
| **Storage Service** | âœ… | Upload + save, bucket EXISTS |
| **Storage Bucket** | âœ… | `tree-photos` (public) |
| **GPS Hook** | âœ… | `useGeolocation.ts` |
| **PhotoCapture** | âœ… | INTEGROVÃNO v HistorySidebar |
| **PhotoGallery** | âœ… | S lightbox modal |
| **AI Assistant** | âœ… | OpenRouter + Gemini support |
| **History Sidebar** | âœ… | ChronologickÃ½ seznam, filtry |
| **PlanModal** | âœ… | S GPS tlaÄÃ­tkem |
| **DayDetailPanel** | âœ… | Detail vybranÃ©ho dne |
| **SettingsModal** | âœ… | API key management |
| **ChatPanel** | âœ… | AI chat interface |
| **Types** | âœ… | KompletnÃ­ TypeScript typy |

---

## âš ï¸ TechnickÃ½ dluh

| Issue | Priorita | Odhad |
|-------|----------|-------|
| Å½Ã¡dnÃ© testy | ğŸŸ¡ STÅ˜EDNÃ | 2-4 hodiny |
| Å½Ã¡dnÃ¡ autentizace | ğŸŸ¡ STÅ˜EDNÃ | 4-8 hodin |
| NenÃ­ PWA | ğŸŸ¢ NÃZKÃ | 2-3 hodiny |

---

## ğŸ”§ ZmÄ›ny od 30.1.2026

### Opraveno 31.1.2026:
1. **Circular dependency** mezi `settingsService.ts` a `chatService.ts`
   - VytvoÅ™en `services/ai/types.ts` se sdÃ­lenÃ½m `AIProvider` typem

### Korekce pÅ™edchozÃ­ho auditu:
| PÅ¯vodnÃ­ claim | SkuteÄnost |
|---------------|------------|
| âŒ PhotoCapture neintegrovanÃ© | âœ… INTEGROVÃNO v HistorySidebar |
| âŒ Storage bucket neexistuje | âœ… EXISTUJE (`tree-photos`, public) |
| âŒ Leaflet balÃ­Äky v package.json | âœ… ODSTRANÄšNY |

---

## DatabÃ¡zovÃ¡ struktura (ovÄ›Å™eno)

| Tabulka | Å˜Ã¡dkÅ¯ | Popis |
|---------|-------|-------|
| `events` | existuje | PlÃ¡novanÃ© akce |
| `event_items` | existuje | PoloÅ¾ky akcÃ­ |
| `trees` | 2 | VysazenÃ© stromy |
| `tree_photos` | 2 | Fotky stromÅ¯ |
| `storage.buckets` | 1 | tree-photos (public) |

---

## DoporuÄenÃ­ pro dalÅ¡Ã­ vÃ½voj

1. **VysokÃ¡ priorita:**
   - PÅ™idat zÃ¡kladnÃ­ unit testy (Vitest)
   - Implementovat autentizaci

2. **StÅ™ednÃ­ priorita:**
   - PWA manifest
   - Offline podpora

3. **NÃ­zkÃ¡ priorita:**
   - Marker clustering pro 5000+ stromÅ¯
   - Export dat
